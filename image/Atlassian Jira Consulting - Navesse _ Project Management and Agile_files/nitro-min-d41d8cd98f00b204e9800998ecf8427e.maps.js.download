(function($,window,document,undefined){"use strict";function GoogleMaps(e,t){var a;this.element=e;this.map_data=$.extend({},{},t);a=this.map_data.map_options;this.settings=$.extend({zoom:"5",map_type_id:"ROADMAP",scroll_wheel:true,map_visual_refresh:false,full_screen_control:false,full_screen_control_position:"BOTTOM_RIGHT",zoom_control:true,zoom_control_style:"SMALL",zoom_control_position:"TOP_LEFT",map_type_control:true,map_type_control_style:"HORIZONTAL_BAR",map_type_control_position:"RIGHT_TOP",scale_control:true,street_view_control:true,street_view_control_position:"TOP_LEFT",overview_map_control:true,center_lat:"40.6153983",center_lng:"-74.2535216",draggable:true},{},a);this.container=$("div[rel='"+$(this.element).attr("id")+"']");var o=false;if(this.map_data.map_tabs&&this.map_data.map_tabs.direction_tab){o=this.map_data.map_tabs.direction_tab.suppress_markers}this.directionsService=new google.maps.DirectionsService;this.directionsDisplay=new google.maps.DirectionsRenderer({suppressMarkers:o});this.drawingmanager={};this.geocoder=new google.maps.Geocoder;this.places=[];this.show_places=[];this.categories={};this.tabs=[];this.all_shapes=[];this.wpgmp_polylines=[];this.wpgmp_polygons=[];this.wpgmp_circles=[];this.wpgmp_shape_events=[];this.wpgmp_rectangles=[];this.per_page_value=0;this.current_amenities=[];this.route_directions=[];this.search_area="";this.markerClusterer=null;this.infowindow_marker=new google.maps.InfoWindow;this.init()}GoogleMaps.prototype={init:function(){var map_obj=this;var center=new google.maps.LatLng(map_obj.settings.center_lat,map_obj.settings.center_lng);map_obj.map=new google.maps.Map(map_obj.element,{zoom:parseInt(map_obj.settings.zoom),center:center,disableDoubleClickZoom:map_obj.settings.scroll_wheel!="false",scrollwheel:map_obj.settings.scroll_wheel,zoomControl:map_obj.settings.zoom_control===true,fullscreenControl:map_obj.settings.full_screen_control===true,fullscreenControlOptions:{position:eval("google.maps.ControlPosition."+map_obj.settings.full_screen_control_position)},zoomControlOptions:{style:eval("google.maps.ZoomControlStyle."+map_obj.settings.zoom_control_style),position:eval("google.maps.ControlPosition."+map_obj.settings.zoom_control_position)},mapTypeControl:map_obj.settings.map_type_control==true,mapTypeControlOptions:{style:eval("google.maps.MapTypeControlStyle."+map_obj.settings.map_type_control_style),position:eval("google.maps.ControlPosition."+map_obj.settings.map_type_control_position)},scaleControl:map_obj.settings.scale_control==true,streetViewControl:map_obj.settings.street_view_control==true,streetViewControlOptions:{position:eval("google.maps.ControlPosition."+map_obj.settings.street_view_control_position)},overviewMapControl:map_obj.settings.overview_map_control==true,overviewMapControlOptions:{opened:map_obj.settings.overview_map_control},draggable:map_obj.settings.draggable,mapTypeId:eval("google.maps.MapTypeId."+map_obj.settings.map_type_id),styles:eval(map_obj.map_data.styles)});map_obj.map_loaded();map_obj.responsive_map();map_obj.create_markers();map_obj.display_markers();if(map_obj.map_data.street_view){map_obj.set_streetview(center)}if(map_obj.map_data.bicyle_layer){map_obj.set_bicyle_layer()}if(map_obj.map_data.traffic_layer){map_obj.set_traffic_layer()}if(map_obj.map_data.transit_layer){map_obj.set_transit_layer()}if(map_obj.map_data.panoramio_layer){map_obj.set_panoramic_layer()}if(map_obj.settings.display_45_imagery=="45"){map_obj.set_45_imagery()}if(typeof map_obj.map_data.map_visual_refresh===true){map_obj.set_visual_refresh()}if(map_obj.settings.search_control==true){map_obj.show_search_control()}if(map_obj.map_data.listing){$(map_obj.container).on("click",".categories_filter_reset_btn",function(){$(map_obj.container).find(".wpgmp_filter_wrappers select").each(function(){$(this).find("option:first").attr("selected","selected")});$(".wpgmp_search_input").val("");map_obj.update_filters()});$(map_obj.container).on("change",'[data-filter="dropdown"]',function(){map_obj.update_filters()});$(map_obj.container).on("click",'[data-filter="checklist"]',function(){map_obj.update_filters()});$(map_obj.container).on("click",'[data-filter="list"]',function(){if($(this).hasClass("fc_selected")){$(this).removeClass("fc_selected")}else{$(this).addClass("fc_selected")}map_obj.update_filters()});map_obj.display_filters_listing();$.each(map_obj.map_data.listing.filters,function(e,t){$(map_obj.container).find('select[name="'+t+'"]').on("change",function(){map_obj.update_filters()})});$(map_obj.container).find('[data-name="radius"]').on("change",function(){var e=$(map_obj.container).find('[data-input="wpgmp-search-text"]').val();if(e.length>=2&&$(this).val()!=""){map_obj.geocoder.geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK){map_obj.search_area=e[0].geometry.location;map_obj.update_filters()}})}else{map_obj.search_area="";map_obj.update_filters()}});$(map_obj.container).find('[data-filter="map-perpage-location-sorting"]').on("change",function(){map_obj.per_page_value=$(this).val();map_obj.update_filters()});$(map_obj.container).find('[data-input="wpgmp-search-text"]').on("keyup",function(){var e=$(this).val();$(map_obj.container).find('[data-filter="map-radius"]').val("");map_obj.search_area="";if(e.length>=2&&map_obj.map_data.listing.apply_default_radius==true){if(e.length>=2){map_obj.geocoder.geocode({address:e},function(e,t){if(t==google.maps.GeocoderStatus.OK){map_obj.search_area=e[0].geometry.location;map_obj.update_filters()}})}}else{map_obj.update_filters()}})}$("body").on("click",".wpgmp_marker_link",function(){map_obj.open_infowindow($(this).data("marker"));$("html, body").animate({scrollTop:$(map_obj.container).offset().top-150},500)});$(map_obj.container).on("click","a[data-marker]",function(){map_obj.open_infowindow($(this).data("marker"));$("html, body").animate({scrollTop:$(map_obj.container).offset().top-150},500)});$(map_obj.container).on("click","a[data-marker]",function(){map_obj.open_infowindow($(this).data("marker"))});map_obj.google_auto_suggest($(".wpgmp_auto_suggest"))},createMarker:function(e){var t=this;var a=t.map;var o=e.geometry.location;var i={url:e.icon,size:new google.maps.Size(25,25),scaledSize:new google.maps.Size(25,25)};e.marker=new google.maps.Marker({map:a,position:e.geometry.location,icon:i});google.maps.event.addListener(e.marker,"click",function(){if(t.settings.map_infowindow_customisations===true)t.amenity_infowindow.setContent('<div class="wpgmp_infowindow"><div class="wpgmp_iw_content">'+e.name+"</div></div>");else t.amenity_infowindow.setContent(e.name);t.amenity_infowindow.open(a,this)});t.current_amenities.push(e)},marker_bind:function(t){var i=this;google.maps.event.addListener(t,"drag",function(){var e=t.getPosition();i.geocoder.geocode({latLng:e},function(e,t){if(t==google.maps.GeocoderStatus.OK){$("#googlemap_address").val(e[0].formatted_address);$(".google_city").val(i.wpgmp_finddata(e[0],"administrative_area_level_3")||i.wpgmp_finddata(e[0],"locality"));$(".google_state").val(i.wpgmp_finddata(e[0],"administrative_area_level_1"));$(".google_country").val(i.wpgmp_finddata(e[0],"country"));if(e[0].address_components){for(var a=0;a<e[0].address_components.length;a++){for(var o=0;o<e[0].address_components[a].types.length;o++){if(e[0].address_components[a].types[o]=="postal_code"){wpgmp_zip_code=e[0].address_components[a].long_name;$(".google_postal_code").val(wpgmp_zip_code)}}}}}});$(".google_latitude").val(e.lat());$(".google_longitude").val(e.lng())})},google_auto_suggest:function(e){var n=this;e.each(function(){var t=this;var o=new google.maps.places.Autocomplete(this);o.bindTo("bounds",n.map);if($(this).attr("name")=="location_address"){var e=n.infowindow_marker;var i=new google.maps.Marker({map:n.map,draggable:true,anchorPoint:new google.maps.Point(0,-29)});n.marker_bind(i);google.maps.event.addListener(o,"place_changed",function(){var e=o.getPlace();if(!e.geometry){return}if(e.geometry.viewport){n.map.fitBounds(e.geometry.viewport)}else{n.map.setCenter(e.geometry.location);n.map.setZoom(17)}$(".google_latitude").val(e.geometry.location.lat());$(".google_longitude").val(e.geometry.location.lng());$(".google_city").val(n.wpgmp_finddata(e,"administrative_area_level_3")||n.wpgmp_finddata(e,"locality"));$(".google_state").val(n.wpgmp_finddata(e,"administrative_area_level_1"));$(".google_country").val(n.wpgmp_finddata(e,"country"));if(e.address_components){for(var t=0;t<e.address_components.length;t++){for(var a=0;a<e.address_components[t].types.length;a++){if(e.address_components[t].types[a]=="postal_code"){wpgmp_zip_code=e.address_components[t].long_name;$(".google_postal_code").val(wpgmp_zip_code)}}}}i.setPosition(e.geometry.location);i.setVisible(true)})}else{google.maps.event.addListener(o,"place_changed",function(){var e=o.getPlace();if(!e.geometry){return}$().val(e.geometry.location.lat());$(t).data("longitude",e.geometry.location.lng());$(t).data("latitude",e.geometry.location.lat())})}})},wpgmp_finddata:function(e,a){var o="";for(var t=0;t<e.address_components.length;++t){var i=e.address_components[t];$.each(i.types,function(e,t){if(t==a){o=i.long_name}})}return o},open_infowindow:function(a){var o=this;$.each(this.map_data.places,function(e,t){if(parseInt(t.id)==parseInt(a)&&t.marker.visible===true){o.openInfoWindow(t)}})},place_info:function(a){var o;$.each(this.places,function(e,t){if(parseInt(t.id)==parseInt(a)){o=t}});return o},event_listener:function(e,t,a){google.maps.event.addListener(e,t,a)},set_visual_refresh:function(){google.maps.visualRefresh=true},set_45_imagery:function(){this.map.setTilt(45)},set_bicyle_layer:function(){var e=new google.maps.BicyclingLayer;e.setMap(this.map)},set_traffic_layer:function(){var e=new google.maps.TrafficLayer;e.setMap(this.map)},set_panoramic_layer:function(){var e=new google.maps.panoramio.PanoramioLayer;e.setMap(this.map)},set_transit_layer:function(){var e=new google.maps.TransitLayer;e.setMap(this.map)},set_streetview:function(e){var t={position:e,addressControlOptions:{position:google.maps.ControlPosition.BOTTOM_CENTER},linksControl:this.map_data.street_view.links_control,panControl:this.map_data.street_view.street_view_pan_control,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},enableCloseButton:this.map_data.street_view.street_view_close_button};if(this.map_data.street_view.pov_heading&&this.map_data.street_view.pov_pitch){t["pov"]={heading:parseInt(this.map_data.street_view.pov_heading),pitch:parseInt(this.map_data.street_view.pov_pitch)}}var a=new google.maps.StreetViewPanorama(this.element,t)},sortByPlace:function(i,n){return function(e,t){if(t[i]&&e[i]){if(e[i]&&t[i]){var a=e[i].toLowerCase();var o=t[i].toLowerCase();if(n=="num"){a=parseInt(a);o=parseInt(o)}return a<o?-1:a>o?1:0}}}},sort_object_by_keyvalue:function(e,t,a,o){var i=[];for(var n in e){i.push(e[n])}i.sort(this.sortByPlace(t,a));if(o=="desc"){i.reverse()}return i},create_filters:function(){var a=this;var e="";var o={};var t=this.map_data.places;var i=this.map_data.listing;$.each(t,function(e,t){if(typeof t.categories=="undefined"){t.categories={}}$.each(t.categories,function(e,t){if(typeof o[t.type]=="undefined"){o[t.type]={}}if(t.name){if(t.extension_fields&&t.extension_fields.cat_order){o[t.type][t.name]={id:t.id,order:t.extension_fields.cat_order,name:t.name}}else{o[t.type][t.name]={id:t.id,order:0,name:t.name}}}})});var n="",s="name",r="",l="asc";if(a.map_data.listing){if(a.map_data.listing.default_sorting){if(a.map_data.listing.default_sorting.orderby=="listorder"){s="order";r="num";l=a.map_data.listing.default_sorting.inorder}l=a.map_data.listing.default_sorting.inorder}}$.each(o,function(e,t){if(i.display_category_filter===true&&e=="category"){n+='<select data-filter="dropdown" data-name="category" name="place_'+e+'">';n+='<option value="">'+wpgmp_local.select_category+"</option>";t=a.sort_object_by_keyvalue(t,s,r,l);$.each(t,function(e,t){n+="<option value='"+t.id+"'>"+t.name+"</option>"});n+="</select>"}});return n},update_filters:function(){var e=this;var a={};var t=$(e.container).find('[data-filter="dropdown"]');var o=$(e.container).find('[data-filter="checklist"]:checked');var i=$(e.container).find('[data-filter="list"].fc_selected');$.each(t,function(e,t){if($(this).val()!=""){if(typeof a[$(this).data("name")]=="undefined"){a[$(this).data("name")]=[]}a[$(this).data("name")].push($(this).val())}});$.each(o,function(e,t){if(typeof a[$(this).data("name")]=="undefined"){a[$(this).data("name")]=[]}a[$(this).data("name")].push($(this).val())});$.each(i,function(e,t){if(typeof a[$(this).data("name")]=="undefined"){a[$(this).data("name")]=[]}a[$(this).data("name")].push($(this).data("value").toString())});this.apply_filters(a)},apply_filters:function(t){var o=this;var c=true;var n=true;o.show_places=[];var _=false;if($(o.container).find('[data-input="wpgmp-search-text"]').length>0){var s=$(o.container).find('[data-input="wpgmp-search-text"]').val();s=s.toLowerCase();if(s.length>0){_=true}}if(o.map_data.map_tabs&&o.map_data.map_tabs.category_tab&&o.map_data.map_tabs.category_tab.cat_tab===true||$(o.container).find("input[data-marker-category]").length>0){var d=$(o.container).find("input[data-marker-category]:checked");var r=[];var l=[];if(d.length>0){$.each(d,function(e,t){r.push($(t).data("marker-category"));var a=$(t).closest('[data-container="wpgmp-category-tab-item"]').find("input[data-marker-location]:not(:checked)");if(a.length>0){$.each(a,function(e,t){l.push($(t).data("marker-location"))})}})}var m=$(o.container).find('[data-container="wpgmp-category-tab-item"]').find("input[data-marker-location]:checked");var p=[];if(m.length>0){$.each(m,function(e,t){p.push($(t).data("marker-location"))})}}if(typeof o.map_data.places!="undefined"){$.each(o.map_data.places,function(e,i){n=true;if(typeof t!="undefined"){$.each(t,function(e,a){var o=false;if($.isArray(a)){if(typeof i.categories!="undefined"&&e=="category"){$.each(i.categories,function(e,t){if($.inArray(t.id,a)>-1){o=true}})}if(typeof i[e]!="undefined"){if($.inArray(i[e],a)>-1){o=true}}else if(typeof i.location[e]!="undefined"){if($.inArray(i.location[e],a)>-1){o=true}}else if(i.location.extra_fields&&typeof i.location.extra_fields[e]!="undefined"){var t=a[0];if(i.location.extra_fields[e]&&i.location.extra_fields[e].indexOf(t)>-1){o=true}else if($.inArray(i.location.extra_fields[e],a)>-1){o=true}}if(o==false)n=false}else{a.val=""}})}if(_===true&&n===true){if(i.title!=undefined&&i.title.toLowerCase().indexOf(s)>=0){n=true}else if(i.content!=undefined&&i.content.toLowerCase().indexOf(s)>=0){n=true}else if(i.location.lat.toLowerCase().indexOf(s)>=0){n=true}else if(i.location.lng.toLowerCase().indexOf(s)>=0){n=true}else if(i.address&&i.address.toLowerCase().indexOf(s)>=0){n=true}else if(i.location.state&&i.location.state.toLowerCase().indexOf(s)>=0){n=true}else if(i.location.country&&i.location.country.toLowerCase().indexOf(s)>=0){n=true}else if(i.location.postal_code&&i.location.postal_code.toLowerCase().indexOf(s)>=0){n=true}else if(i.location.city&&i.location.city.toLowerCase().indexOf(s)>=0){n=true}else if(typeof o.search_area!="undefined"&&o.search_area!=""&&o.wpgmp_within_radius(i,o.search_area)===true){n=true}else{n=false}if(typeof i.location.extra_fields!="undefined"){$.each(i.location.extra_fields,function(e,t){if(t){t=t.toString();if(t&&t.toLowerCase().indexOf(s)>=0)n=true}})}}if((i.categories.length==undefined||i.categories.length=="undefined")&&r&&r.length>0&&$(o.container).find('input[name="wpgmp_select_all"]').is(":checked")==false&&n){n=false}if(r&&n!=false&&i.categories.length!=undefined){var a=false;if(r.length===0){if(typeof i.categories!="undefined"){$.each(i.categories,function(e,t){if(t.id==="")a=true})}}else{if(typeof i.categories!="undefined"){$.each(i.categories,function(e,t){if(t.id==="")a=true;else if($.inArray(parseInt(t.id),r)>-1){a=true;i.marker.setIcon(t.icon)}})}}if(l.length!==0){if($.inArray(parseInt(i.id),l)>-1){a=false}}if(a===false)n=false;else n=true;if(p.length!==0){if($.inArray(parseInt(i.id),p)>-1){n=true}}}i.marker.visible=n;i.marker.setVisible(n);if(n==false){i.infowindow.close()}i.marker.setAnimation(null);if(n===true)o.show_places.push(i)})}if(typeof o.map_data.map_options.bound_map_after_filter!==typeof undefined&&o.map_data.map_options.bound_map_after_filter===true){var f=new google.maps.LatLngBounds;for(var e=0;e<o.show_places.length;e++){var g=new google.maps.LatLng(o.show_places[e]["location"]["lat"],o.show_places[e]["location"]["lng"]);f.extend(g)}o.map.fitBounds(f)}if(o.map_data.listing){if($(o.container).find('[data-filter="map-sorting"]').val()){var a=$(o.container).find('[data-filter="map-sorting"]').val().split("__");var i="";if(a[0]!==""&&a[1]!==""){if(typeof a[2]!="undefined"){i=a[2]}o.sorting(a[0],a[1],i)}}else{if(o.map_data.listing.default_sorting){var i="";if(o.map_data.listing.default_sorting.orderby=="listorder"){i="num"}o.sorting(o.map_data.listing.default_sorting.orderby,o.map_data.listing.default_sorting.inorder,i)}}}if(o.map_data.marker_cluster){o.set_marker_cluster()}},display_filters_listing:function(){if(this.map_data.listing){var e='<div class="wpgmp_filter_wrappers">'+this.display_filters()+"</div>";$(this.container).find(".wpgmp_map_parent").after(e)}},display_filters:function(){var e=this.map_data.listing.hide_locations;var t="";t+='<div class="wpgmp_before_listing">'+this.map_data.listing.listing_header+"</div>";t+='<div class="categories_filter">'+this.create_filters()+'<div data-container="wpgmp-filters-container"></div>';t+="</div>";return t},map_loaded:function(){var i=this;var t=i.map;google.maps.event.addListenerOnce(t,"idle",function(){var e=t.getCenter();google.maps.event.trigger(t,"resize");t.setCenter(e)});if(i.settings.center_by_nearest===true){i.center_by_nearest()}if(i.settings.close_infowindow_on_map_click===true){google.maps.event.addListener(t,"click",function(e){$.each(i.places,function(e,t){t.infowindow.close();t.marker.setAnimation(null)})})}if(i.settings.map_infowindow_customisations===true){google.maps.event.addListener(i.infowindow_marker,"domready",function(){var e=$(i.container).find(".gm-style-iw");e.parent().css({width:"0px",height:"0px"});var t=e.next();t.css("display","none");var a=e.prev();a.children(":nth-child(2)").css({display:"none"});a.children(":nth-child(3)").css({"background-color":"#000;"});a.children(":nth-child(4)").css({display:"none"});var o=e.outerHeight();a.children(":nth-child(3)").css({top:o+18+"px"});a.children(":nth-child(1)").css({top:o+10+"px"});a.children(":nth-child(3)").find("div").children().css({"box-shadow":i.settings.infowindow_border_color+" 0px 1px 6px",border:"1px solid "+i.settings.infowindow_border_color,"border-top":"","z-index":"1","background-color":i.settings.infowindow_bg_color});e.find(".wpgmp_infowindow").prepend('<div class="infowindow-close"></div>');e.on("click",".infowindow-close",function(e){$.each(i.places,function(e,t){t.infowindow.close();t.marker.setAnimation(null)})})})}},resize_map:function(){var e=this;var t=e.map;var a=t.getZoom();var o=t.getCenter();google.maps.event.trigger(this.map,"resize");t.setZoom(a);t.setCenter(o)},responsive_map:function(){var e=this;var a=e.map;google.maps.event.addDomListener(window,"resize",function(){var e=a.getZoom();var t=a.getCenter();google.maps.event.trigger(a,"resize");a.setZoom(e);a.setCenter(t);a.getBounds()})},show_search_control:function(){var map_obj=this;var input=$(map_obj.container).find('[data-input="map-search-control"]')[0];if(input!==undefined){var searchBox=new google.maps.places.Autocomplete(input);if(wpgmp_local.wpgmp_country_specific&&wpgmp_local.wpgmp_country_specific==true){searchBox.setComponentRestrictions({country:wpgmp_local.wpgmp_countries})}map_obj.map.controls[eval("google.maps.ControlPosition."+map_obj.settings.search_control_position)].push(input);searchBox.bindTo("bounds",map_obj.map);google.maps.event.addListener(searchBox,"place_changed",function(){var e=searchBox.getPlace();map_obj.map.setCenter(e.geometry.location);map_obj.map.setZoom(parseInt(map_obj.map_data.map_options.map_zoom_after_search))})}},fit_bounds:function(){var e=this;var t=e.map_data.places;var a=new google.maps.LatLngBounds;if(t!==undefined){t.forEach(function(e){if(e.location.lat&&e.location.lng){a.extend(new google.maps.LatLng(parseFloat(e.location.lat),parseFloat(e.location.lng)))}})}e.map.fitBounds(a)},create_markers:function(){var c=this;var a=c.map_data.places;var e;var _;var d=[];$.each(a,function(e,t){if(t.location.lat&&t.location.lng){if(typeof t.categories=="undefined"){t.categories={}}t.marker=new google.maps.Marker({position:new google.maps.LatLng(parseFloat(t.location.lat),parseFloat(t.location.lng)),icon:t.location.icon,url:t.url,draggable:t.location.draggable,map:c.map,clickable:t.location.infowindow_disable});if(c.settings.infowindow_drop_animation===true){t.marker.setAnimation(google.maps.Animation.DROP)}if(c.settings.infowindow_filter_only===true){t.marker.visible=false;t.marker.setVisible(false)}if(c.map_data.page=="edit_location")c.marker_bind(t.marker);var a=[];if(typeof t.categories!="undefined"){for(var o in t.categories){a.push(t.categories[o].name)}}var i="";var n="";if(t.source=="post"){n=t.location.extra_fields.post_featured_image}else{n=t.location.marker_image}var s="";if(t.source=="post"){s=c.settings.infowindow_geotags_setting}else{s=c.settings.infowindow_setting}if(typeof s=="undefined"){s=t.content}_={"{marker_id}":t.id,"{marker_title}":t.title,"{marker_address}":t.address,"{marker_latitude}":t.location.lat,"{marker_longitude}":t.location.lng,"{marker_city}":t.location.city,"{marker_state}":t.location.state,"{marker_country}":t.location.country,"{marker_postal_code}":t.location.postal_code,"{marker_zoom}":t.location.zoom,"{marker_icon}":t.location.icon,"{marker_category}":a.join(","),"{marker_message}":t.content,"{marker_image}":n};if(typeof t.location.extra_fields!="undefined"){for(var r in t.location.extra_fields){if(!t.location.extra_fields[r]){_["{"+r+"}"]=""}else{_["{"+r+"}"]=t.location.extra_fields[r]}}}s=s.replace(/{[^{}]+}/g,function(e){if(e in _){return _[e]}else{return""}});i=s;if(i===""){if(c.settings.map_infowindow_customisations===true&&c.settings.show_infowindow_header===true)i='<div class="wpgmp_infowindow"><div class="wpgmp_iw_head"><div class="wpgmp_iw_head_content">'+t.title+'</div></div><div class="wpgmp_iw_content">'+t.content+"</div></div>";else i='<div class="wpgmp_infowindow"><div class="wpgmp_iw_content">'+t.content+"</div></div>"}else{if(c.settings.map_infowindow_customisations===true&&c.settings.show_infowindow_header===true)i='<div class="wpgmp_infowindow"><div class="wpgmp_iw_head"><div class="wpgmp_iw_head_content">'+t.title+'</div></div><div class="wpgmp_iw_content">'+i+"</div></div>";else i='<div class="wpgmp_infowindow"><div class="wpgmp_iw_content">'+i+"</div></div>"}t.infowindow_data=i;t.infowindow=c.infowindow_marker;if(t.location.infowindow_default_open===true){c.openInfoWindow(t)}else if(c.settings.default_infowindow_open===true){c.openInfoWindow(t)}var l=c.settings.infowindow_open_event;var p=c.settings.infowindow_bounce_animation;c.event_listener(t.marker,l,function(){$.each(c.places,function(e,t){t.infowindow.close();t.marker.setAnimation(null)});c.openInfoWindow(t);if(p=="click"){c.toggle_bounce(t.marker)}});if(p=="mouseover"&&l!="mouseover"){c.event_listener(t.marker,"mouseover",function(){t.marker.setAnimation(google.maps.Animation.BOUNCE)});c.event_listener(t.marker,"mouseout",function(){t.marker.setAnimation(null)})}if(p!=""){google.maps.event.addListener(t.infowindow,"closeclick",function(){t.marker.setAnimation(null)})}c.places.push(t)}else{d.push(e)}});$.each(d,function(e,t){a.splice(t,1)})},toggle_bounce:function(e){if(e.getAnimation()!==null){e.setAnimation(null)}else{e.setAnimation(google.maps.Animation.BOUNCE)}},display_markers:function(){var e=this;e.show_places=[];e.categories=[];var a={};for(var t=0;t<e.places.length;t++){e.places[t].marker.setMap(e.map);if(e.places[t].marker.visible===true){e.show_places.push(this.places[t])}if(typeof e.places[t].categories!="undefined"){$.each(e.places[t].categories,function(e,t){if(typeof a[t.name]=="undefined"){a[t.name]=t}})}}this.categories=a},get_current_location:function(t,a){var o=this;if(typeof o.user_location=="undefined"){navigator.geolocation.getCurrentPosition(function(e){o.user_location=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);if(t)t(o.user_location)},function(e){if(a)a(e)},{enableHighAccuracy:true,timeout:5e3,maximumAge:0})}else{if(t)t(o.user_location)}},openInfoWindow:function(e){var t=this;e.infowindow=t.infowindow_marker;e.infowindow.setContent(e.infowindow_data);if(e.location.onclick_action=="custom_link"){if(e.location.open_new_tab=="yes")window.open(e.location.redirect_custom_link,"_blank");else window.open(e.location.redirect_custom_link,"_self")}else{e.infowindow.open(this.map,e.marker);if(typeof t.settings.infowindow_click_change_center!="undefined"&&t.settings.infowindow_click_change_center==true){t.map.setCenter(e.marker.getPosition())}if(typeof t.settings.infowindow_click_change_zoom!="undefined"&&t.settings.infowindow_click_change_zoom>0){t.map.setZoom(t.settings.infowindow_click_change_zoom)}if(this.map_data.map_tabs&&this.map_data.map_tabs.direction_tab&&this.map_data.map_tabs.direction_tab.dir_tab===true){$(this.container).find(".start_point").val(e.address)}}}};$.fn.maps=function(e,t){this.each(function(){if(!$.data(this,"wpgmp_maps")){$.data(this,"wpgmp_maps",new GoogleMaps(this,e,t))}});return this}})(jQuery,window,document);