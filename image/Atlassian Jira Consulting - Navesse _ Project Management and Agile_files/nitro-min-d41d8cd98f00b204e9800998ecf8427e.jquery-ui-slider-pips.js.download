(function(b){"use strict";var e={pips:function(e){var d=this,u,i,l,s="",a,h=d._valueMin(),n=d._valueMax(),c=(n-h)/d.options.step,r=d.element.find(".ui-slider-handle"),t;var v={first:"label",last:"label",rest:"pip",labels:false,prefix:"",suffix:"",step:c>100?Math.floor(c*.05):1,formatLabel:function(e){return this.prefix+e+this.suffix}};if(b.type(e)==="object"||b.type(e)==="undefined"){b.extend(v,e);d.element.data("pips-options",v)}else{if(e==="destroy"){f()}else if(e==="refresh"){d.element.slider("pips",d.element.data("pips-options"))}return}d.options.pipStep=Math.abs(Math.round(v.step))||1;d.element.off(".selectPip").addClass("ui-slider-pips").find(".ui-slider-pip").remove();var o={single:function(s){this.resetClasses();t.filter(".ui-slider-pip-"+this.classLabel(s)).addClass("ui-slider-pip-selected");if(d.options.range){t.each(function(e,i){var l=b(i).children(".ui-slider-label").data("value");if(d.options.range==="min"&&l<s||d.options.range==="max"&&l>s){b(i).addClass("ui-slider-pip-inrange")}})}},range:function(s){this.resetClasses();for(u=0;u<s.length;u++){t.filter(".ui-slider-pip-"+this.classLabel(s[u])).addClass("ui-slider-pip-selected-"+(u+1))}if(d.options.range){t.each(function(e,i){var l=b(i).children(".ui-slider-label").data("value");if(l>s[0]&&l<s[1]){b(i).addClass("ui-slider-pip-inrange")}})}},classLabel:function(e){return e.toString().replace(".","-")},resetClasses:function(){var l=/(^|\s*)(ui-slider-pip-selected|ui-slider-pip-inrange)(-{1,2}\d+|\s|$)/gi;t.removeClass(function(e,i){return(i.match(l)||[]).join(" ")})}};function p(i){var e,l,s,a,t,n=[],r=0;if(d.values()&&d.values().length){s=d.values();a=b.map(s,function(e){return Math.abs(e-i)});t=Math.min.apply(Math,a);for(e=0;e<a.length;e++){if(a[e]===t){n.push(e)}}r=n[0];for(l=0;l<n.length;l++){if(d._lastChangedValue===n[l]){r=n[l]}}if(d.options.range&&n.length===2){if(i>s[1]){r=n[1]}else if(i<s[0]){r=n[0]}}}return r}function f(){d.element.off(".selectPip").on("mousedown.slider",d.element.data("mousedown-original")).removeClass("ui-slider-pips").find(".ui-slider-pip").remove()}function m(e,i){if(d.option("disabled")){return}var l=b(e).data("value"),s=p(l);if(d.values()&&d.values().length){d.options.values[s]=d._trimAlignValue(l)}else{d.options.value=d._trimAlignValue(l)}d._refreshValue();d._change(i,s)}function g(e){var i,l,s=e,a="ui-slider-pip",t="",n=d.value(),r=d.values(),o,f,p;if(e==="first"){s=0}else if(e==="last"){s=c}o=h+d.options.step*s;f=o.toString().replace(".","-");p=s+h-h;if(b.type(v.labels)==="array"){i=v.labels[p]||""}else if(b.type(v.labels)==="object"){if(e==="first"){i=v.labels.first||""}else if(e==="last"){i=v.labels.last||""}else if(b.type(v.labels.rest)==="array"){i=v.labels.rest[p-1]||""}else{i=o}}else{i=o}if(e==="first"){l="0%";a+=" ui-slider-pip-first";a+=v.first==="label"?" ui-slider-pip-label":"";a+=v.first===false?" ui-slider-pip-hide":""}else if(e==="last"){l="100%";a+=" ui-slider-pip-last";a+=v.last==="label"?" ui-slider-pip-label":"";a+=v.last===false?" ui-slider-pip-hide":""}else{l=(100/c*e).toFixed(4)+"%";a+=v.rest==="label"?" ui-slider-pip-label":"";a+=v.rest===false?" ui-slider-pip-hide":""}a+=" ui-slider-pip-"+f;if(r&&r.length){for(u=0;u<r.length;u++){if(o===r[u]){a+=" ui-slider-pip-initial-"+(u+1);a+=" ui-slider-pip-selected-"+(u+1)}}if(d.options.range){if(o>r[0]&&o<r[1]){a+=" ui-slider-pip-inrange"}}}else{if(o===n){a+=" ui-slider-pip-initial";a+=" ui-slider-pip-selected"}if(d.options.range){if(d.options.range==="min"&&o<n||d.options.range==="max"&&o>n){a+=" ui-slider-pip-inrange"}}}t=d.options.orientation==="horizontal"?"left: "+l:"bottom: "+l;return'<span class="'+a+'" style="'+t+'">'+'<span class="ui-slider-line"></span>'+'<span class="ui-slider-label" data-value="'+o+'">'+v.formatLabel(i)+"</span>"+"</span>"}s+=g("first");for(l=d.options.pipStep;l<c;l+=d.options.pipStep){s+=g(l)}s+=g("last");d.element.append(s);t=d.element.find(".ui-slider-pip");if(b._data(d.element.get(0),"events").mousedown&&b._data(d.element.get(0),"events").mousedown.length){a=b._data(d.element.get(0),"events").mousedown}else{a=d.element.data("mousedown-handlers")}d.element.data("mousedown-handlers",a.slice());for(i=0;i<a.length;i++){if(a[i].namespace==="slider"){d.element.data("mousedown-original",a[i].handler)}}d.element.off("mousedown.slider").on("mousedown.selectPip",function(e){var i=b(e.target),l=p(i.data("value")),s=r.eq(l);s.addClass("ui-state-active");if(i.is(".ui-slider-label")){m(i,e);d.element.one("mouseup.selectPip",function(){s.removeClass("ui-state-active").focus()})}else{var a=d.element.data("mousedown-original");a(e)}});d.element.on("slide.selectPip slidechange.selectPip",function(e,i){var l=b(this),s=l.slider("value"),a=l.slider("values");if(i){s=i.value;a=i.values}if(d.values()&&d.values().length){o.range(a)}else{o.single(s)}})},float:function(e){var s,a=this,t=a._valueMin(),n=a._valueMax(),i=a._value(),l=a._values(),r=[],f=a.element.find(".ui-slider-handle");var o={handle:true,pips:false,labels:false,prefix:"",suffix:"",event:"slidechange slide",formatLabel:function(e){return this.prefix+e+this.suffix}};if(b.type(e)==="object"||b.type(e)==="undefined"){b.extend(o,e);a.element.data("float-options",o)}else{if(e==="destroy"){d()}else if(e==="refresh"){a.element.slider("float",a.element.data("float-options"))}return}if(i<t){i=t}if(i>n){i=n}if(l&&l.length){for(s=0;s<l.length;s++){if(l[s]<t){l[s]=t}if(l[s]>n){l[s]=n}}}a.element.addClass("ui-slider-float").find(".ui-slider-tip, .ui-slider-tip-label").remove();function d(){a.element.off(".sliderFloat").removeClass("ui-slider-float").find(".ui-slider-tip, .ui-slider-tip-label").remove()}function p(e){var i=[],l=b.map(e,function(e){return Math.ceil((e-t)/a.options.step)});if(b.type(o.labels)==="array"){for(s=0;s<e.length;s++){i[s]=o.labels[l[s]]||e[s]}}else if(b.type(o.labels)==="object"){for(s=0;s<e.length;s++){if(e[s]===t){i[s]=o.labels.first||t}else if(e[s]===n){i[s]=o.labels.last||n}else if(b.type(o.labels.rest)==="array"){i[s]=o.labels.rest[l[s]-1]||e[s]}else{i[s]=e[s]}}}else{for(s=0;s<e.length;s++){i[s]=e[s]}}return i}if(o.handle){r=a.values()&&a.values().length?p(l):p([i]);for(s=0;s<r.length;s++){f.eq(s).append(b('<span class="ui-slider-tip">'+o.formatLabel(r[s])+"</span>"))}}if(o.pips){a.element.find(".ui-slider-label").each(function(e,i){var l=b(i),s=[l.data("value")],a,t;a=o.formatLabel(p(s)[0]);t=b('<span class="ui-slider-tip-label">'+a+"</span>").insertAfter(l)})}if(o.event!=="slide"&&o.event!=="slidechange"&&o.event!=="slide slidechange"&&o.event!=="slidechange slide"){o.event="slidechange slide"}a.element.off(".sliderFloat").on(o.event+".sliderFloat",function(e,i){var l=b.type(i.value)==="array"?i.value:[i.value],s=o.formatLabel(p(l)[0]);b(i.handle).find(".ui-slider-tip").html(s)})}};b.extend(true,b.ui.slider.prototype,e)})(jQuery);